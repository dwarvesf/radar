"use strict";var _interopRequireDefault=require("@babel/runtime-corejs2/helpers/interopRequireDefault");var _keys=_interopRequireDefault(require("@babel/runtime-corejs2/core-js/object/keys"));var _asyncToGenerator2=_interopRequireDefault(require("@babel/runtime-corejs2/helpers/asyncToGenerator"));var _unfetch=_interopRequireDefault(require("unfetch"));var _eventSourcePolyfill=_interopRequireDefault(require("./event-source-polyfill"));var _eventsource=require("./error-overlay/eventsource");var _onDemandEntriesUtils=require("./on-demand-entries-utils");/* globals __webpack_hash__ */if(!window.EventSource){window.EventSource=_eventSourcePolyfill.default;}const data=JSON.parse(document.getElementById('__NEXT_DATA__').textContent);let{assetPrefix,page}=data;assetPrefix=assetPrefix||'';let mostRecentHash=null;/* eslint-disable-next-line */let curHash=__webpack_hash__;const hotUpdatePath=assetPrefix+(assetPrefix.endsWith('/')?'':'/')+'_next/static/webpack/';// Is there a newer version of this code available?
function isUpdateAvailable(){// __webpack_hash__ is the hash of the current compilation.
// It's a global variable injected by Webpack.
/* eslint-disable-next-line */return mostRecentHash!==__webpack_hash__;}// Webpack disallows updates in other states.
function canApplyUpdates(){return module.hot.status()==='idle';}// This function reads code updates on the fly and hard
// reloads the page when it has changed.
function tryApplyUpdates(){return _tryApplyUpdates.apply(this,arguments);}function _tryApplyUpdates(){_tryApplyUpdates=(0,_asyncToGenerator2.default)(function*(){if(!isUpdateAvailable()||!canApplyUpdates()){return;}try{const res=yield(0,_unfetch.default)(""+hotUpdatePath+curHash+".hot-update.json");const data=yield res.json();const curPage=page==='/'?'index':page;const pageUpdated=(0,_keys.default)(data.c).some(mod=>{return mod.indexOf("pages"+(curPage.substr(0,1)==='/'?curPage:"/"+curPage))!==-1||mod.indexOf(("pages"+(curPage.substr(0,1)==='/'?curPage:"/"+curPage)).replace(/\//g,'\\'))!==-1;});if(pageUpdated){document.location.reload(true);}else{curHash=mostRecentHash;}}catch(err){console.error('Error occurred checking for update',err);document.location.reload(true);}});return _tryApplyUpdates.apply(this,arguments);}(0,_eventsource.getEventSourceWrapper)({path:assetPrefix+"/_next/webpack-hmr"}).addMessageListener(event=>{if(event.data==='\uD83D\uDC93'){return;}try{const message=JSON.parse(event.data);if(message.action==='sync'||message.action==='built'){if(!message.hash){return;}mostRecentHash=message.hash;tryApplyUpdates();}else if(message.action==='reloadPage'){document.location.reload(true);}}catch(ex){console.warn('Invalid HMR message: '+event.data+'\n'+ex);}});(0,_onDemandEntriesUtils.setupPing)(assetPrefix,()=>page);